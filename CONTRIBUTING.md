# Contributing to the library

We employ several tools to maintain our library. This guide will walk you
through their usage and help ensure your contributions meet our standards.

## The `make pre-commit` Tool

The `make pre-commit` tool checks library conventions and performs basic tasks.
Before you run it, ensure your new files have been added to the `git`
repository. Installation instructions for the `make pre-commit` tool can be
found [here](HOWTO-INSTALL.html#after-the-setup).

The `make pre-commit` tool can generate errors during the first run while
correcting some of them automatically. If all goes well, the second run should
pass all checks and initiate the verification of the entire library via
`make check`.

Below is a summary of the tasks this tool performs:

- **Trailing Whitespace**: Identifies and removes any trailing whitespace.

- **End of Files**: Detects and eliminates any trailing blank lines at the end
  of a file.

- **Mixed Line Ending**:

- **Double Quoted Strings**:

- **Python AST**:

- **YAML**:

- **Case Conflicts**:

- **Merge Conflicts**: Checks for any merge conflict artifacts in the code.

- **Added Large Files**:

- **Markdown Conventions**:

- **Blank Line Conventions**: Searches for and removes any double or multiple
  blank lines.

- **Agda Space Conventions**:

- **Indentation Conventions**: Verifies that the indentation level is always a
  multiple of two. If inconsistencies are found, it provides an error report
  indicating the location of the issues.

- **Fix Simply Wrappable Long Lines**: Scans for any lines exceeding the
  80-character limit that can be resolved by inserting line breaks. It inserts
  line breaks at the beginning of any definition, but not in the middle of a
  definition.

- **Maximum Line Length**: Detects any violations of the 80-character line limit
  and reports them. Note that single tokens such as long names can exceed this
  limit.

- **Create Index of Modules**: Generates and maintains the index of modules for
  each folder in `src`. For example, the `group-theory/` folder has a
  corresponding `src/group-theory.lagda.md` file that imports all the modules in
  `group-theory/` publicly. You do not need to maintain these files manually.

- **Generate Index File for the Entire Library**: Generates
  `src/everything.lagda.md`, which imports all formalization files across the
  library. This file is also regenerated by `make check` each time it's run. No
  manual maintenance is required for this file.

- **Python Scripts**:

- **Markdown Formatting**: Performs basic markdown formatting tasks such as
  enforcing the 80-character line limit, formatting markdown tables, among
  others.

## The `make website` Tool

After you complete the `make pre-commit` process, run `make website` to verify
that the current changes will not interfere with the website's compilation. This
tool starts by running `make check` and then builds the website, reporting any
broken internal links that may prevent the website build from completing.

Installation instructions for the `make website` tool can be found
[here](HOWTO-INSTALL.html#after-the-setup)

## Submitting Your Pull Request on GitHub

Once all checks are passed, you're ready to submit your pull request. Please
provide a brief description of the significant changes you made. Keep in mind
that the individual commits in your pull request will be squashed into a single
commit, and its commit message will be the description you provide in your pull
request.
